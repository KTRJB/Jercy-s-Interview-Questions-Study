## 1. **HTTP와 HTTPS의 차이**

### HTTP와 HTTPS의 개요

HTTP(HyperText Transfer Protocol)는 웹에서 정보를 주고받는 데 사용되는 기본 프로토콜입니다. HTTPS(HyperText Transfer Protocol Secure)는 HTTP에 **보안 계층**을 추가하여 데이터를 암호화하고, 이를 통해 사용자 정보 보호와 데이터 무결성을 보장합니다.

---

## 2. **HTTP와 HTTPS의 주요 차이점**

### 1) **보안 수준**

| 특징            | **HTTP**             | **HTTPS**                                            |
| ------------- | -------------------- | ---------------------------------------------------- |
| **데이터 암호화**   | 평문(Plaintext) 데이터 전송 | SSL/TLS를 통해 데이터를 암호화하여 전송                            |
| **보안 인증**     | 보안 인증서를 사용하지 않음      | 인증기관(CA: Certificate Authority)이 발급한 SSL/TLS 인증서를 사용 |
| **중간자 공격 방지** | 데이터를 가로채기 쉬움         | 데이터 암호화로 중간자 공격(Man-in-the-Middle)을 방지               |

```
중간자(MITM) 공격은 해커가 사용자와 웹 애플리케이션과 같은 두 온라인 대상 간의 통신을 도청하여 민감한 정보를 훔치는 사이버 공격을 의미
```

### 2) **사용 목적**

| **HTTP**                                | **HTTPS**                             |
| --------------------------------------- | ------------------------------------- |
| 일반적인 정보 교환(공공 데이터 제공 등)          | 보안이 중요한 데이터 교환(로그인, 결제 정보, 개인정보 등) |
| 예: 블로그, 공공 자료 제공 사이트              | 예: 은행, 전자상거래, 이메일 서비스 등         |

### 3) **속도 및 리소스 소비**

| 항목               | **HTTP**                                  | **HTTPS**                                   |
| ------------------ | ----------------------------------------- | ------------------------------------------ |
| **속도**            | 암호화 과정이 없어 속도가 빠름                  | 암호화/복호화로 인해 약간의 속도 저하 가능          |
| **리소스 소비**      | 서버 리소스 사용량이 적음                     | SSL/TLS 암호화로 추가 리소스 소모             |

---

## 3. **iOS에서의 보안 통신 방법**

### 1) **App Transport Security(ATS)의 개요**

ATS(App Transport Security)는 iOS 9.0 및 macOS 10.11 이상에서 애플리케이션과 웹 서비스 간 통신의 보안을 강화하기 위해 도입된 기능입니다. ATS는 모든 인터넷 통신에서 **안전한 프로토콜(HTTPS)을 사용하도록 강제**하여 **사용자의 민감한 정보가 유출되는 것을 방지**합니다.

#### ATS의 주요 특징:
1. **HTTP 차단**  
   - ATS가 활성화되면 암호화되지 않은 HTTP 통신은 OS 내부에서 강제로 차단됩니다.
2. **TLS 1.2 이상 요구**  
   - 최신 암호화 표준인 TLS 1.2 이상을 사용해야 합니다.
3. **강력한 암호화 알고리즘 적용**  
   - 안전한 암호화 및 인증서를 요구하여 보안 수준을 강화합니다.

---

### 2) **ATS의 등장 배경**

#### 배경 및 필요성:
- 다양한 애플리케이션이 **연락처, 사진, 건강 정보, 메시지** 등 민감한 데이터를 다루면서 사용자 정보 보호의 중요성이 증가했습니다.  
- 기존의 보안/암호화 기술이 오래되어 공격에 취약해졌으며, 새로운 네트워크 공격이 더 강력해졌습니다.  
- 이러한 변화에 대응하기 위해 2015년 ATS가 도입되었으며, 2016년부터는 모든 신규 애플리케이션에 ATS 사용이 요구되었습니다.

#### 도입 효과:
- 사용자 데이터의 안전한 전송 보장
- 애플리케이션의 보안 취약점 감소

---

### 3) **ATS의 동작 방식**

ATS는 **표준 URL 로딩 시스템**(URLSession, CFURL, NSURLConnection API)을 사용해 데이터를 송수신할 때 자동으로 적용됩니다.  

#### ATS의 동작 프로세스:
1. **자동 적용**  
   - URLSession 인스턴스는 가능한 가장 안전한 연결을 선택하며, 보안되지 않은 URL 요청은 차단됩니다.
2. **HTTPS 요구**  
   - 앱은 `https://`로 시작하는 URL을 사용해야 하며, 그렇지 않은 경우 ATS가 연결을 거부하고 콘솔에 오류 메시지를 출력합니다.
3. **강화된 보안 요구사항**  
   - 서버는 TLS 1.2 이상을 지원해야 하며, 안전한 암호화 알고리즘 및 인증서를 사용해야 합니다.

---

### 4) **ATS의 보안 요구사항**

#### 연결 허용 조건:
1. **최신 TLS 프로토콜 사용**  
   - TLS 1.2 이상을 지원해야 합니다.
2. **강력한 암호화 알고리즘 사용**  
   - RSA 키는 최소 2048비트, ECC 키는 최소 256비트를 사용.
   - SHA-256 이상의 암호화 해시 알고리즘이 필요.
3. **제한된 암호 목록 사용**  
   - Apple에서 허용한 안전한 암호화 스위트만 사용할 수 있습니다.

#### 비준수 시 동작:
- 서버가 위 요구 사항을 충족하지 못할 경우, 연결이 실패하거나 경고 메시지가 출력됩니다.

---

### 5) **ATS의 예외 처리**

특정 상황에서는 ATS를 우회해야 할 수도 있습니다. 예를 들어, 보안이 강화되지 않은 서버와 통신해야 하는 경우 **Info.plist** 파일을 통해 예외를 설정할 수 있습니다.

#### 예외 설정 방법:
1. **Info.plist 수정**  
   - `NSExceptionDomains` 키를 사용하여 특정 도메인에 예외를 설정.
2. **예외 항목**  
   - `NSIncludesSubdomains`: 서브도메인 포함 여부.
   - `NSTemporaryExceptionAllowsInsecureHTTPLoads`: HTTP 허용 여부.
   - `NSTemporaryExceptionMinimumTLSVersion`: 최소 TLS 버전 설정.

---

## 4. **SSL/TLS의 동작 원리**

### 1) **SSL/TLS 개요**

SSL(Secure Sockets Layer)과 TLS(Transport Layer Security)는 네트워크에서 보안 통신을 제공하기 위한 프로토콜입니다. 이들은 종종 디지털 인증서로 불리며, 브라우저(사용자의 컴퓨터)와 서버(웹사이트) 사이의 암호화된 연결을 수립하는 데 사용됩니다. TLS는 SSL의 후속 버전으로 더 안전하고 효율적입니다.

---

### 2) SSL 동작 개요

SSL(Secure Socket Layer)은 **대칭키 암호화**와 **공개키 암호화**를 혼합하여 사용하는 인터넷 보안 프로토콜입니다. 이를 통해 안전한 데이터 전송과 통신 상대방의 신원을 보장합니다.

---

### 3) 암호화 알고리즘

#### (1) 대칭키 암호화

![image](https://github.com/user-attachments/assets/c47baf15-6d2e-4658-9a43-1c559586da55)

(이미지 출처: https://preamtree.tistory.com/38)

• 암호화와 복호화에 동일한 키(대칭키)를 사용합니다.
• **시나리오**
1. A와 B는 **같은 대칭키를 공유**해야 합니다.
	• 대칭키는 직접 만나서 전달하거나, 다른 안전한 방법으로 주고받아야 합니다.
	• 이 과정에서 키가 유출되면 통신이 위험해질 수 있습니다.
2. A가 메시지를 대칭키로 암호화합니다.
	• 예: 평문 HELLO → 암호문 12345.
3. B는 A가 보낸 암호문을 대칭키로 복호화합니다.
	• 암호문 12345 → 평문 HELLO.
• 장점: 처리 속도가 빠릅니다.
• 단점 :대칭키를 안전하게 전달하기 어렵습니다.

#### (2) **공개키 암호화**

![image](https://github.com/user-attachments/assets/b4dc03c7-5619-4ae9-90a3-4153060f73ee)

(이미지 출처: https://preamtree.tistory.com/38)

• **공개키(Public Key)**로 암호화하고, **비밀키(Private Key)**로 복호화합니다.
• 시나리오
1. B는 자신의 **공개키**를 생성하고, 이를 공개합니다.
	• B의 공개키는 누구나 사용할 수 있습니다.
2. A는 B의 공개키로 메시지를 암호화합니다.
	• 예: 평문 HELLO → 암호문 67890 (B의 공개키 사용).
	• 이 암호문은 오직 B의 **비밀키**로만 복호화할 수 있습니다.
3. B는 자신의 비밀키로 암호문을 복호화합니다.
	• 암호문 67890 → 평문 HELLO.
• 장점: 키를 미리 공유하지 않아도 안전합니다.
• 단점: **암복호화** 과정이 복잡하고 속도가 느립니다.

```
SSL은 두 방식의 장단점을 조합하여 안전하고 효율적인 통신을 구현합니다.
```
#### (3) 대칭키와 공개키의 혼합 방식 (SSL 초기 예시)

• **시나리오**
1. B는 자신의 **공개키**를 공개합니다.
2. A는 B의 공개키를 사용해 통신에 사용할 **대칭키**를 암호화하여 B에게 보냅니다.
	• 평문 대칭키 MyKey123 → 암호문 XYZ789.
3. B는 자신의 **비밀키**로 암호화된 대칭키를 복호화합니다.
	• 암호문 XYZ789 → 평문 대칭키 MyKey123.
4. 이후 A와 B는 공유한 대칭키를 사용해 통신합니다.
	• 데이터 전송: 평문 DATA → 암호문 456DEF.
	• 데이터 수신: 암호문 456DEF → 평문 DATA.
• **장점**
	• 공개키로 대칭키를 안전하게 교환하므로 **대칭키의 보안 문제**를 해결합니다.
	• 이후 통신은 대칭키로 이루어지므로 **효율적**입니다.

---

## 4) SSL 동작 과정: 간단

위에서 설명한 대칭키와 공개키 암호화 방식을 결합한 방법을 기반으로, 상대방이 해커인지 아닌지, 즉 신뢰할 수 있는지 확인하는 추가적인 알고리즘이 적용됩니다. 이 방식의 핵심적인 절차는 다음과 같습니다:

![image](https://github.com/user-attachments/assets/6f9382bc-cc73-4892-9a7c-0748d5718a82)

(이미지출처: https://minix.tistory.com/397)

1. **사이트와 인증 기관의 초기 상호작용**

사이트는 자신의 신원과 공개 키를 인증 기관에 제출합니다. 이때, 사이트의 공개 키와 관련 정보가 포함됩니다.

2. **인증 기관의 검토 및 암호화**

인증 기관은 제출된 사이트의 정보와 공개 키를 검토한 후, 이를 인증 기관의 개인 키로 암호화합니다. 이 암호화된 정보는 인증서로 사용됩니다.

3. **인증서 전송**

인증 기관은 인증기관의 비밀키로 암호화된 사이트의 정보와 공개 키를 사이트로 전송합니다. 이 과정은 안전하게 사이트의 신뢰성을 증명하는 데 사용됩니다.

4. **브라우저와 사이트 간 인증서 수신**

사용자가 브라우저를 통해 사이트에 접속하면, 브라우저는 사이트로부터 암호화된 사이트의 정보와 공개 키를 인증서 형태로 받습니다.

5. **인증서 검증**

브라우저는 자신에게 내장된 인증 기관 공개 키(해당 공개키는 브라우저에게만 제공됨)를 사용하여 인증서를 복호화합니다. 이 과정을 통해 사이트의 인증서가 신뢰할 수 있는 인증 기관에서 발급된 것인지를 확인함과 동시에 사이트의 정보와 공개 키를 얻습니다.

6. **대칭 키 전송 준비**

브라우저는 대칭 키를 생성하고, 이를 사이트의 공개 키로 암호화하여 사이트로 전송합니다.

7. **대칭 키 복호화**

사이트는 자신의 개인 키를 사용하여 암호화된 대칭 키를 복호화합니다. 이제 사이트와 브라우저는 안전하게 데이터를 주고받을 수 있게 됩니다.

8. **대칭 키를 통한 안전한 통신**

대칭 키를 사용하여 사이트와 브라우저는 암호화된 데이터를 주고받으며, 안전한 연결이 성립됩니다.


---

## 5) SSL 동작 과정: 세부

![image](https://github.com/user-attachments/assets/dc18ef7d-776a-44bf-87f4-452c15184a14)

(이미지 출처: https://lbm93.tistory.com/18)

앞서 설명한 바와 같이, SSL은 서버와 클라이언트가 서로 실제 데이터를 주고 받을 때 사용되는 암호화 방법은 대칭키를 사용하고 이 대칭키를 암호화할때 사용하는 암호화 방법이 공개키 방법입니다. SSL 통신은 “악수(HandShake) → 데이터 전송 → 세션 종료"의 세 가지 주요 단계로 나뉩니다. 이 과정은 상대방이 신뢰할 수 있는지 확인하고, 데이터를 안전하게 주고받을 수 있는 방법을 결정합니다.

**1. SSL 핸드쉐이크(HandShake) 단계**

SSL 통신의 첫 번째 단계인 핸드쉐이크에서는 서버와 클라이언트가 안전하게 데이터를 교환하기 위한 준비를 합니다. 이 과정에서 암호화 방식과 인증서를 교환하여, 두 시스템이 신뢰할 수 있는 통신을 설정합니다.

1) **클라이언트 Hello**
	• 클라이언트는 서버에 접속을 요청하며, 자신이 지원하는 암호화 방식과 세션 정보를 서버에 전송합니다.
	• **지원하는 암호화 방식**: 클라이언트가 지원하는 암호화 알고리즘을 나열하여 서버와 협상합니다.
	• **세션 아이디**: 이전에 설정된 세션이 있다면, 이를 재활용할 수 있도록 서버에게 세션 식별자를 전송합니다.

2) **서버 Hello**
	• 서버는 클라이언트의 요청에 대해 응답하며, 다음과 같은 정보를 클라이언트에게 전달합니다.
	• **서버가 생성한 랜덤 데이터**: 서버가 핸드쉐이크를 시작하는 데 필요한 랜덤 값을 생성하여 클라이언트에 보냅니다.
	• **암호화 방식 선택**: 클라이언트가 전송한 암호화 방식 중에서 서버가 사용할 수 있는 방식을 선택하여 전송합니다.
	• **서버 인증서**: 서버는 자신의 인증서와 공개키를 클라이언트에게 전달합니다.

3) **클라이언트 인증서 확인**
	• 클라이언트는 서버로부터 받은 인증서를 **CA(Certificate Authority)**의 공개키로 복호화하여, 서버의 인증서가 신뢰할 수 있는 CA에 의해 발급되었는지 확인합니다.
	• 만약 인증서가 신뢰할 수 없는 경우, 클라이언트는 경고 메시지를 표시할 수 있습니다.
	• 복호화에 성공했다면 인증서는 CA의 개인키로 암호화된 문서임이 암시적으로 보증된 것입니다.(서버 신뢰 가능)

  
**2. 세션 키 생성 및 암호화**

1) 클라이언트 **Pre-Master Secret 생성**
	• 클라이언트는 '서버 Hello' 과정에서 서버로부터 받은 랜덤 데이터와 클라이언트가 생성한 랜덤 데이터를 조합하여 **pre-master secret**이라는 키를 생성합니다.
	• 이 값은 세션 단계에서 데이터를 주고 받을 때 암호화에 사용되는 **session key**를 생성하는 데 이용됩니다.
	• 세션 키는 대칭키 방식으로 암호화되기 때문에 제3자에게 노출이 되면 안됩니다.
	• 따라서 공개키 방식으로 서버에 안전하게 전달됩니다.
		• 인증서를 통해 전달받은 서버의 공개키로 **pre-master secret**을 암호화
		• 서버는 자신의 개인키(=비공개키)로 안전하게 복호화

2) **서버 복호화**
	• 서버는 자신의 비공개키를 사용하여 **pre-master secret** 값을 복호화합니다.
	• 이후 클라이언트와 서버는 이 값을 바탕으로 **master secret**을 생성하고, 이를 이용해 **session key**를 만듭니다.


**3. 데이터 전송**

1) **세션 키로 암호화된 데이터 전송**
	• 클라이언트와 서버는 생성된 **session key**를 사용하여 데이터를 암호화하고 주고받습니다.
	• 대칭키 방식으로 빠르고 효율적으로 데이터를 암호화하여 전송합니다.

2) **암호화된 데이터 해독**
	• 수신 측은 동일한 **session key**를 사용하여 데이터를 복호화합니다. 이렇게 함으로써 두 시스템은 안전하게 데이터를 주고받을 수 있습니다.

  

**4. 세션 종료**

1) **세션 종료**
	• 데이터 전송이 완료되면, 서버와 클라이언트는 서로에게 통신 종료를 알리고, 사용된 **session key**는 폐기됩니다.
	• 세션이 종료된 후, 해당 세션에 대한 암호화 키는 더 이상 사용되지 않으며, 새로운 연결이 필요하면 새로운 핸드쉐이크가 진행됩니다.


위의 과정을 정리하면 다음과 같습니다.

```
SSL은 공개키 방식과 대칭키 방식을 결합하여 사용합니다:

• 공개키 방식은 데이터 전송 시 안전하지만, 많은 컴퓨터 자원을 소모하므로 pre-master secret을 암호화하는 데만 사용됩니다.

• 대칭키 방식은 상대방과 동일한 키를 사용하여 데이터를 암호화하므로 빠르고 효율적입니다. 실제 데이터 전송은 이 방식으로 이루어집니다.

SSL은 공개키 방식으로 세션 키를 안전하게 전달하고, 실제 데이터 전송에는 대칭키 방식으로 효율적으로 암호화된 데이터를 주고받습니다.
```

---

## 6) SSL과 TLS 비교

TLS(Transport Layer Security)와 SSL(Secure Sockets Layer)은 기본적으로 비슷한 목적을 가진 보안 프로토콜로, 네트워크 상에서 데이터를 안전하게 암호화하여 전송하는 역할을 합니다. 하지만 TLS는 SSL을 개선한 버전으로, 두 프로토콜은 몇 가지 중요한 차이점이 있습니다.


**주요 차이점: SSL과 TLS**

1. **보안 강화**
	• **SSL**은 초기 버전에서 여러 보안 취약점이 발견되었으며, 이러한 취약점들은 현대의 공격 기법에 의해 쉽게 뚫릴 수 있었습니다.
	• **TLS**는 SSL의 취약점을 개선하고 보안성을 강화한 버전으로, 새로운 암호화 알고리즘과 향상된 핸드쉐이크 절차를 사용합니다. TLS는 SSL보다 강력한 보안을 제공합니다.

2. **암호화 알고리즘**
	• **SSL**과 **TLS**는 기본적으로 동일한 암호화 기법(대칭키 암호화, 공개키 암호화)을 사용하지만, **TLS**는 더 강력하고 효율적인 암호화 알고리즘을 제공합니다.
	• 예를 들어, TLS는 더 나은 해시 함수(SHA-256 이상)와 더 강력한 키 교환 알고리즘을 지원합니다.

3. **핸드쉐이크 프로세스**
	• **TLS**는 **SSL**보다 더 정교하고 효율적인 핸드쉐이크 절차를 가지고 있습니다. 예를 들어, TLS는 서버 인증서 검증을 더 철저히 수행하며, 서버와 클라이언트의 키 교환 과정을 더 안전하게 처리합니다.
	• TLS 1.2 이후에는 “디폴트”로 더 안전한 암호화 방법을 사용하도록 강화되었습니다.

4. **버전 차이**
	• **SSL**은 여러 버전(SSL 1.0, SSL 2.0, SSL 3.0)이 있었으나, 대부분의 버전은 보안상의 이유로 더 이상 사용되지 않습니다.
	• **TLS**는 SSL 3.0의 후속으로, TLS 1.0부터 시작하여 현재 TLS 1.2와 TLS 1.3 버전이 가장 널리 사용되고 있습니다. TLS 1.3은 TLS 프로토콜의 최신 버전으로, 성능과 보안성이 크게 향상되었습니다.

5. **프로토콜 이름**
	• SSL은 원래 **Netscape**에서 개발한 프로토콜이며, 이후 여러 기업과 단체들이 이를 개선하고 발전시킨 결과 **TLS**라는 이름으로 발전했습니다.
	• 실제로 **SSL**이라는 용어는 이제 더 이상 사용되지 않으며, **TLS**라는 이름이 널리 쓰입니다. 다만, 많은 사람들이 여전히 “SSL”이라고 부르지만, 현재는 TLS를 의미하는 경우가 많습니다.

  

**요약**

• **SSL**은 이제 더 이상 사용되지 않으며, **TLS**가 그 후속 프로토콜로 사용됩니다.
• **TLS**는 SSL의 보안 취약점을 개선하고, 더 나은 성능과 보안 기능을 제공합니다.
• 최신 웹 브라우저 및 서버는 **TLS**만을 사용하며, **SSL**은 더 이상 지원되지 않거나 제한적으로만 사용됩니다.


결론적으로, **TLS는 SSL을 개선한 프로토콜**로, 보안과 성능에서 향상된 버전입니다. SSL을 사용하던 시스템도 이제 TLS를 사용하도록 업데이트되었습니다.

---

## 참고문서

- [AWS - HTTP와 HTTPS의 차이](https://aws.amazon.com/ko/compare/the-difference-between-https-and-http/)
- [Apple Developer Documentation - App Transport Security](https://developer.apple.com/documentation)  
- [SSL/TLS 개요 및 동작 원리](https://medium.com)  
- [TLS의 기술적 상세 설명](https://en.wikipedia.org/wiki/Transport_Layer_Security)
- [SSL, TLS, HTTPS는 무엇인가요](https://www.digicert.com/kr/what-is-ssl-tls-and-https)
- [iOS 네트워킹 정복하기: ATS(App Transport Security)](https://velog.io/@averycode/iOS-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%82%B9-%EC%A0%95%EB%B3%B5%ED%95%98%EA%B8%B0-7-ATS-App-Transport-Security-o3vf1xp4)
- [[IT 기술면접 준비자료] 대칭키, 공개키 방식과 SSL(TLS)](https://preamtree.tistory.com/38)
- [[웹툰04] SSL이란 무엇인가? 2/2](https://minix.tistory.com/397)
- [[SSL 제대로 이해하기 4탄] SSL 동작 과정](https://lbm93.tistory.com/18)
